{"version":3,"file":"chunk-154fc642.js","sources":["../src/components/Button/Button.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport Ink from \"react-ink\";\n\nimport BootstrapButton from \"react-bootstrap/Button\";\n\nimport \"./Button.scss\";\nimport \"../../base/fixed-width.scss\";\n\nconst LOADING_TEXTS = [\n  \"Still working...\",\n  \"Mostly done...\",\n  \"A bit more...\",\n  \"Almost done...\"\n];\n\nconst LOADING_DELAY = 10000;\n\nconst Button = ({\n  color,\n  width,\n  loading,\n  disabled,\n  children,\n  onClick,\n  ...props\n}) => {\n  const initialText = children;\n  const [text, setText] = useState(initialText);\n  const [loadingIndex, setLoadingIndex] = useState(-1);\n  const prevLoading = usePrevious(loading);\n  const _disabled = loading || disabled;\n\n  let classes = classNames({\n    [\"btn-\" + color]: color,\n    [\"width-\" + width]: width,\n    disabled: _disabled\n  });\n\n  let buttonTexts = [];\n\n  if (loading) {\n    const initialLoadingText =\n      typeof loading === \"string\" ? loading : \"Please wait...\";\n\n    buttonTexts = [initialLoadingText, ...LOADING_TEXTS];\n  }\n\n  useEffect(() => {\n    let timer;\n\n    if (loading) {\n      if (!prevLoading) {\n        // switched from not loading, to loading\n        updateLoadingText();\n      }\n\n      loadingIndex < buttonTexts.length - 1 &&\n        (timer = setTimeout(() => updateLoadingText(), LOADING_DELAY));\n    } else if (prevLoading) {\n      reset();\n    }\n\n    return () => {\n      clearTimeout(timer);\n    };\n  }, [loading, loadingIndex]);\n\n  useEffect(() => {\n    let newText = loading ? buttonTexts[loadingIndex] : children;\n    setText(newText);\n  }, [children, loadingIndex]);\n\n  function updateLoadingText() {\n    setLoadingIndex(prev => prev + 1);\n  }\n\n  function reset() {\n    setText(initialText);\n    setLoadingIndex(-1);\n  }\n\n  function _onClick() {\n    !_disabled && onClick && onClick();\n  }\n\n  return (\n    <BootstrapButton\n      variant={color}\n      className={classes}\n      disabled={_disabled}\n      onClick={_onClick}\n      {...props}\n    >\n      {text}\n      <Ink />\n    </BootstrapButton>\n  );\n};\n\nButton.propTypes = {\n  variant: PropTypes.oneOf([\"primary\", \"tertiary\", \"secondary\", \"link\"]),\n  color: PropTypes.oneOf([\"accent\", \"success\", \"danger\", \"warning\", \"info\"]),\n  width: PropTypes.oneOf([32, 64, 96, 128, \"auto\"]),\n  type: PropTypes.oneOf([\"button\", \"submit\", \"reset\"]),\n  disabled: PropTypes.bool,\n  loading: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  children: PropTypes.node,\n  onClick: PropTypes.func\n};\n\nButton.defaultProps = {\n  variant: \"secondary\",\n  color: \"accent\",\n  type: \"button\",\n  width: \"auto\",\n  disabled: false\n};\n\nfunction usePrevious(value) {\n  const ref = useRef();\n  useEffect(() => {\n    ref.current = value;\n  });\n  return ref.current;\n}\n\nexport default Button;\n"],"names":["LOADING_TEXTS","LOADING_DELAY","Button","color","width","loading","disabled","children","onClick","props","initialText","useState","text","setText","loadingIndex","setLoadingIndex","prevLoading","usePrevious","_disabled","classes","classNames","buttonTexts","initialLoadingText","useEffect","timer","updateLoadingText","length","setTimeout","reset","clearTimeout","newText","prev","_onClick","React","BootstrapButton","Ink","propTypes","variant","PropTypes","oneOf","type","bool","oneOfType","string","node","func","defaultProps","value","ref","useRef","current"],"mappings":"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"}